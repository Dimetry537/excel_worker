# Copilot Instructions for excel_worker

## Архитектура и основные компоненты
- Проект построен на Python, структура разделена на папки `src/`, `migrations/`, и корневые конфигурационные файлы.
- В `src/` находятся основные модули: API (`src/api/`), модели (`src/models/`), репозитории (`src/repository/`), схемы (`src/schemas/`), задачи (`src/tasks/`), и база данных (`src/db/`).
- API-слой реализует бизнес-логику и взаимодействует с репозиториями, которые инкапсулируют работу с моделями и базой данных.
- Миграции базы данных управляются через Alembic (`migrations/`).
- Конфигурация и запуск приложения — через `main.py` и `src/app.py`.

## Важные рабочие процессы
- **Запуск приложения:** основной вход — `main.py` или `src/app.py`.
- **Миграции:** используйте Alembic (`alembic.ini`, папка `migrations/`).
- **Сборка и запуск в контейнере:** используйте `Dockerfile` и `docker-compose.yml`.
- **Управление зависимостями:** через Poetry (`pyproject.toml`, `poetry.lock`).
- **Makefile** содержит часто используемые команды (например, тесты, сборка, миграции) — проверьте его для автоматизации.

## Конвенции и паттерны
- Все бизнес-объекты оформлены как отдельные модели (`src/models/`) и репозитории (`src/repository/`).
- API-эндпоинты группируются по сущностям (например, `src/api/doctor.py`, `src/api/nurse.py`).
- Схемы сериализации/валидации — в `src/schemas/`.
- Для задач и фоновых процессов используйте `src/tasks/`.
- Конфигурация базы данных — в `src/db/config.py`.
- Для расширения функционала добавляйте новые модели, репозитории и API-эндпоинты по аналогии с существующими.

## Интеграции и зависимости
- Внешние зависимости управляются через Poetry.
- Для работы с БД используйте SQLAlchemy (см. `src/db/base.py`).
- Миграции — Alembic.
- Контейнеризация — Docker.

## Примеры паттернов
- Репозиторий: см. `src/repository/base_repository.py` и специализированные репозитории.
- Модель: см. `src/models/doctor.py`, `src/models/nurse.py`.
- API: см. `src/api/doctor.py`, `src/api/nurse.py`.
- Схема: см. `src/schemas/personal_base.py`.

## Основные API-эндпоинты
Все эндпоинты сгруппированы по сущностям в `src/api/`.
Примеры:
  - **Доктор (`src/api/doctor.py`)**:
    - POST `/` — создать доктора
    - GET `/` — получить список докторов
    - GET `/{doctor_id}` — получить доктора по id
    - PUT `/{doctor_id}` — обновить доктора
    - DELETE `/{doctor_id}` — удалить доктора
  - **Медсестра (`src/api/nurse.py`)**:
    - POST `/` — создать медсестру
    - GET `/` — получить список медсестер
    - GET `/{nurse_id}` — получить медсестру по id
    - PUT `/{nurse_id}` — обновить медсестру
    - DELETE `/{nurse_id}` — удалить медсестру
  - **CAX-коды (`src/api/cax_codes.py`)**:
    - POST `/` — создать CAX-код
    - GET `/` — получить список CAX-кодов
    - GET `/{cax_id}` — получить CAX-код по id
    - PUT `/{cax_id}` — обновить CAX-код
    - DELETE `/{cax_id}` — удалить CAX-код
  - **Медицинская история (`src/api/medical_history.py`)**:
    - POST `/` — создать историю
    - GET `/` — получить список историй
    - GET `/{history_id}` — получить историю по id
    - PUT `/{history_id}` — обновить историю
    - DELETE `/{history_id}` — удалить историю
Все эндпоинты используют асинхронные функции и схемы для сериализации/валидации.

## Рекомендации для AI-агентов
Следуйте существующей структуре при добавлении новых сущностей.
Используйте Makefile для типовых задач.
При изменении моделей — не забывайте обновлять миграции.
Для новых интеграций — добавляйте зависимости в `pyproject.toml`.

---
_Обновите этот файл при изменении архитектуры или рабочих процессов._
